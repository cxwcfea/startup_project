function copycode1(a){var b=document.getElementById(a);if(is_ie&&"none"!=b.style.display){alert("复制成功");var c=document.body.createTextRange();c.moveToElementText(b),c.scrollIntoView(),c.select(),c.execCommand("Copy"),c.collapse(!1)}else alert("该浏览器不支持此功能，请Ctrl+C复制")}$(function(){$(".jq_topLogin").hover(function(){$(".jq_LoginBox").show(),$(this).addClass("TopLoginBoxSelected")},function(){$(".jq_LoginBox").hide(),$(this).removeClass("TopLoginBoxSelected")}),$(".jq_khdBox").hover(function(){$(this).find("div").show(),$(this).addClass("khdBoxSelected")},function(){$(this).find("div").hide(),$(this).removeClass("khdBoxSelected")}),$(".errorText").click(function(){$(this).hide(),$(this).prev("input").focus()}),$(".login-btn").click(function(){$(".errorText").show()})});var lang=new Array,userAgent=navigator.userAgent.toLowerCase(),is_opera=-1!=userAgent.indexOf("opera")&&opera.version(),is_moz="Gecko"==navigator.product&&userAgent.substr(userAgent.indexOf("firefox")+8,3),is_ie=-1!=userAgent.indexOf("msie")&&!is_opera&&userAgent.substr(userAgent.indexOf("msie")+5,3);!function(){var a=[moment("2015-03-14").dayOfYear(),moment("2015-03-15").dayOfYear(),moment("2015-03-21").dayOfYear(),moment("2015-03-22").dayOfYear(),moment("2015-03-28").dayOfYear(),moment("2015-03-29").dayOfYear(),moment("2015-04-04").dayOfYear(),moment("2015-04-05").dayOfYear(),moment("2015-04-06").dayOfYear(),moment("2015-04-11").dayOfYear(),moment("2015-04-12").dayOfYear(),moment("2015-04-18").dayOfYear(),moment("2015-04-19").dayOfYear(),moment("2015-04-25").dayOfYear(),moment("2015-04-26").dayOfYear(),moment("2015-05-01").dayOfYear(),moment("2015-05-02").dayOfYear(),moment("2015-05-03").dayOfYear(),moment("2015-05-09").dayOfYear(),moment("2015-05-10").dayOfYear(),moment("2015-05-16").dayOfYear(),moment("2015-05-17").dayOfYear(),moment("2015-05-23").dayOfYear(),moment("2015-05-24").dayOfYear(),moment("2015-06-06").dayOfYear(),moment("2015-06-07").dayOfYear(),moment("2015-06-13").dayOfYear(),moment("2015-06-14").dayOfYear(),moment("2015-06-20").dayOfYear(),moment("2015-06-21").dayOfYear(),moment("2015-06-22").dayOfYear(),moment("2015-06-27").dayOfYear(),moment("2015-06-28").dayOfYear(),moment("2015-07-04").dayOfYear(),moment("2015-07-05").dayOfYear(),moment("2015-07-11").dayOfYear(),moment("2015-07-12").dayOfYear(),moment("2015-07-18").dayOfYear(),moment("2015-07-19").dayOfYear(),moment("2015-07-25").dayOfYear(),moment("2015-07-26").dayOfYear(),moment("2015-08-01").dayOfYear(),moment("2015-08-02").dayOfYear(),moment("2015-08-08").dayOfYear(),moment("2015-08-09").dayOfYear(),moment("2015-08-15").dayOfYear(),moment("2015-08-16").dayOfYear(),moment("2015-08-22").dayOfYear(),moment("2015-08-23").dayOfYear(),moment("2015-08-29").dayOfYear(),moment("2015-08-30").dayOfYear(),moment("2015-09-05").dayOfYear(),moment("2015-09-06").dayOfYear(),moment("2015-09-12").dayOfYear(),moment("2015-09-13").dayOfYear(),moment("2015-09-19").dayOfYear(),moment("2015-09-20").dayOfYear(),moment("2015-09-26").dayOfYear(),moment("2015-09-27").dayOfYear(),moment("2015-10-01").dayOfYear(),moment("2015-10-02").dayOfYear(),moment("2015-10-03").dayOfYear(),moment("2015-10-04").dayOfYear(),moment("2015-10-05").dayOfYear(),moment("2015-10-06").dayOfYear(),moment("2015-10-07").dayOfYear(),moment("2015-10-10").dayOfYear(),moment("2015-10-11").dayOfYear(),moment("2015-10-17").dayOfYear(),moment("2015-10-18").dayOfYear(),moment("2015-10-24").dayOfYear(),moment("2015-10-25").dayOfYear(),moment("2015-10-31").dayOfYear(),moment("2015-11-01").dayOfYear(),moment("2015-11-07").dayOfYear(),moment("2015-11-08").dayOfYear(),moment("2015-11-14").dayOfYear(),moment("2015-11-15").dayOfYear(),moment("2015-11-21").dayOfYear(),moment("2015-11-22").dayOfYear(),moment("2015-11-28").dayOfYear(),moment("2015-11-29").dayOfYear(),moment("2015-12-05").dayOfYear(),moment("2015-12-06").dayOfYear(),moment("2015-12-12").dayOfYear(),moment("2015-12-13").dayOfYear(),moment("2015-12-19").dayOfYear(),moment("2015-12-20").dayOfYear(),moment("2015-12-26").dayOfYear(),moment("2015-12-27").dayOfYear()],b=function(){var b=moment().startOf("day");for(moment().hour()>=14&&(b=moment().endOf("day").add(1,"ms"));;){var c=b.dayOfYear();if(-1===a.indexOf(c))break;b=b.add(1,"day")}return b},c=function(b,c,d){var e=b.clone();if(d&&2===d){for(e=e.add(c,"months");-1!==a.indexOf(e.dayOfYear());)e=e.add(1,"day");return e}for(--c;c;)e=e.add(1,"day"),-1===a.indexOf(e.dayOfYear())&&--c;return e.hour(14),e.minute(50),e.second(0),e},d=function(b){for(var c=moment(b).dayOfYear(),d=moment().dayOfYear(),e=0;d>=c;)-1===a.indexOf(d)&&++e,--d;return e};angular.module("commonApp",[]),angular.module("commonApp").value("gbToastr",toastr),angular.module("commonApp").factory("gbNotifier",["gbToastr",function(a){return{notify:function(b){a.success(b)},error:function(b){a.error(b)}}}]),angular.module("commonApp").filter("numTrunc",function(){return function(a){if(a){var b=a.toString(),c=b.search("\\.");c>-1&&(b=b.substr(c))}return b}}).filter("integerNum",function(){return function(a){var b=a,c=b.search("\\.");return c>-1&&(b=b.substr(0,c)),b}}).filter("displayOrderAmount",function(){return function(a,b){var c="";return(2===b||9===b)&&(c="-"),c+a}}).filter("displayIncome",["$filter",function(a){return function(b,c){var d=b;return 2==c||9==c||10==c?"":a("currency")(d,"",2)}}]).filter("displayOutcome",["$filter",function(a){return function(b,c){var d="";return(2==c||9==c||10==c)&&(d=a("currency")(b,"",2)),d}}]).filter("displayMobile",function(){return function(a){return a?(a=a.toString(),a.substr(0,3)+"****"+a.substr(-4)):""}}).filter("displayEmail",function(){return function(a){if(a){var b=a.search("@");return a.substr(0,2)+"***"+a.substr(b)}return""}}).filter("displayIdentityID",function(){return function(a){return a?a.substr(0,4)+"**********"+a.substr(-4):""}}).filter("displayDate",function(){return function(a){return moment(a).format("YYYY-MM-DD HH:mm")}}).filter("displayShortDate",function(){return function(a){return moment(a).format("YYYY-MM-DD")}}).filter("displayCard",["BankNameList",function(a){return function(b){if(b&&b.cardID){var c=b.cardID.toString().substr(12);return a[b.bankID].name+" **** **** **** "+c}return""}}]).filter("displayCard3",function(){return function(a){if(a&&a.cardID){var b=a.cardID.toString().substr(-4),c=a.cardID.toString().substr(0,4);return c+" **** **** "+b}return""}}).filter("displayCard2",["BankNameList",function(){return function(a){if(a&&a.cardID){var b=a.cardID.toString().substr(-4);return b}return""}}]).filter("orderStatus",function(){return function(a){switch(a){case 0:return"等待确认";case 1:return"交易成功";case 2:return"未支付";default:return"未支付"}}}).filter("displayOrderType",function(){return function(a){switch(a){case 1:return"充值";case 2:return"提现";case 3:return"盈利提取";case 4:return"股票盈利";case 5:return"保证金返还";case 6:return"追加配资保证金";case 7:return"配资延期";case 8:return"管理费返还";case 9:return"保证金支出";case 10:return"管理费支出";default:return"充值"}}}).filter("applyStatus",function(){return function(a){switch(a){case 1:return"待支付";case 2:return"操盘中";case 3:return"已结算";case 4:return"审核中";case 5:return"结算中";case 9:return"排队中";default:return"待支付"}}}).filter("payType",function(){return function(a){switch(a){case 0:return"爱贝";case 1:return"盛付通";case 2:return"配资付款";case 3:return"支付宝";case 4:return"银行转账";default:return"无"}}}).service("days",function(){this.startTime=b,this.endTime=c,this.tradeDaysTillNow=d}).service("util",["warn_factor","sell_factor",function(a,b){this.serviceCharge=19.9,this.getServiceCharge=function(a){switch(a){case 10:return 19.9;case 9:return 18.9;case 8:return 17.9;case 7:return 16.9;case 6:return 15.9;case 5:return 10.9;case 4:return 10.9;case 3:return 10.9;case 2:return 10.9;default:return 19.9}},this.getServiceFee=function(a,b){return a.type&&2===a.type?Number(((a.amount-a.amount/a.lever)*a.interestRate).toFixed(2)):(b||(b=a.period),Number((a.amount/1e4*this.getServiceCharge(a.lever)*b).toFixed(2)))},this.getWarnValue=function(b,c){return Number((b-a*c).toFixed(2))},this.getSellValue=function(a,c){return Number((a-b*c).toFixed(2))}}]);var e=[{name:"register_content",value:0,content:"验证码：CODE，用于注册，欢迎来到牛金网，为您提供专业贴心的配资服务。"},{name:"reset_pass_content",value:1,content:"验证码：CODE，用于密码重置，请勿泄露给他人！"},{name:"approve_apply_sms_content",value:2,content:"AMOUNT元资金已到账，股票账号ACCOUNT，登录密码PASSWORD，请勿向任何人泄露！"},{name:"close_apply_sms_content",value:3,content:"业务结算AMOUNT元（保证金DEPOSIT元，收益PROFIT元）已完成，祝您投资愉快。"},{name:"pay_success_sms_content",value:4,content:"充值AMOUNT元已经到账，祝您投资愉快。"},{name:"warn_sms_content",value:5,content:"金额为AMOUNT元的操盘业务已经亏损到达警戒线WARN_AMOUNT元，请尽快追加保证金以维持仓位。"},{name:"sell_sms_content",value:6,content:"金额为AMOUNT元的操盘业务已经亏损到达平仓线SELL_AMOUNT元，系统已经将交易账户平仓，请登录牛金网查看相应信息。"},{name:"withdraw_content",value:7,content:"AMOUNT元资金提现已完成，请注意查收，当前牛金可用余额为BALANCE元。"}];angular.module("commonApp").constant("withdraw_sms_content","您于TIME在牛金网提现AMOUNT元，提现已完成，请注意查收，").constant("get_profit_sms_content","您的盈利提取申请已经处理，资金已划入您在牛金网的余额").constant("approve_apply_sms_content","您有一笔金额为AMOUNT元配资资金已到账，交易账号ACCOUNT，登录密码PASSWORD，您可以通过手机或电脑进行操盘，可以登录牛金网，在我的账户中查看相应账户信息，操盘账户是您操盘的唯一依据，请不要向任何人泄露！").constant("close_apply_sms_content","您在牛金网有一笔TOTAL_AMOUNT元的配资业务已经结算完毕，根据您的操盘收益，该笔配资实际结算AMOUNT元（保证金DEPOSIT元，收益PROFIT元），祝您投资愉快。").constant("pay_success_sms_content","您于TIME在牛金网充值AMOUNT元，资金已经到账，感谢您对牛金网的支持，祝您投资愉快。").constant("warn_sms_content","您有一笔金额为TOTAL_AMOUNT元的操盘业务已经亏损到达警戒线WARN_AMOUNT元，请尽快追加保证金以维持仓位，您可以登录牛金网进行操作，或者联系QQ客服400 692 1388或电话客服400 692 1388。感谢您对牛金网的支持，祝您投资愉快。").constant("sell_sms_content","您有一笔金额为TOTAL_AMOUNT元的操盘业务已经亏损到达平仓线SELL_AMOUNT元，系统已经将交易账户平仓，请登录牛金网查看相应信息，或者联系QQ客服400 692 1388或电话客服400 692 1388。感谢您对牛金网的支持，祝您投资愉快。").constant("sms_macro",e).constant("service_charge",19.9).constant("warn_factor",.4).constant("sell_factor",.6),angular.module("commonApp").constant("BankNameList",[{name:"工商银行",img:"/images/yh/icbc.jpg",instCode:"ICBC",credit:!0,value:0},{name:"建设银行",img:"/images/yh/cbc.jpg",instCode:"CCB",credit:!0,value:1},{name:"农业银行",img:"/images/yh/abc.jpg",instCode:"ABC",credit:!0,value:2},{name:"中国银行",img:"/images/yh/boc.png",instCode:"BOC",credit:!0,value:3},{name:"招商银行",img:"/images/yh/cmb.jpg",instCode:"CMB",credit:!0,value:4},{name:"交通银行",img:"/images/yh/bcs.png",instCode:"COMM",credit:!0,value:5},{name:"邮政储蓄银行",img:"/images/yh/psbc.png",instCode:"PSBC",credit:!1,value:6},{name:"广发银行",img:"/images/yh/cgb.png",instCode:"GDB",credit:!0,value:7},{name:"光大银行",img:"/images/yh/ceb.png",instCode:"CEB",credit:!0,value:8},{name:"兴业银行",img:"/images/yh/cib.png",instCode:"CIB",credit:!0,value:9},{name:"北京银行",img:"/images/yh/bob.png",instCode:"BCCB",credit:!1,value:10},{name:"浦发银行",img:"/images/yh/spdb.png",instCode:"SPDB",credit:!0,value:11},{name:"民生银行",img:"/images/yh/cmbc.png",instCode:"CMBC",credit:!0,value:12},{name:"中信银行",img:"/images/yh/ecitic.png",instCode:"CITIC",credit:!0,value:13},{name:"华夏银行",img:"/images/yh/hx-2.png",instCode:"HXB",credit:!1,value:14},{name:"平安银行",img:"/images/yh/pa.png",instCode:"SZPAB",credit:!0,value:15},{name:"宁波银行",img:"/images/yh/nbcb.png",instCode:"NBCB",credit:!1,value:16},{name:"上海银行",img:"/images/yh/bos.png",instCode:"BOS",credit:!0,value:17}]),angular.module("commonApp").factory("njUser",["$resource",function(a){var b=a("/api/user/:id",{id:"@_id"});return b}]),angular.module("commonApp").factory("njApply",["$resource",function(a){var b=a("/api/user/:uid/applies/:serial_id",{uid:"@userID",serial_id:"@serialID"});return b}]),angular.module("commonApp").factory("njOrder",["$resource",function(a){var b=a("/api/user/:uid/orders/:id",{uid:"@userID",id:"@_id"});return b}]),angular.module("commonApp").factory("njCard",["$resource",function(a){var b=a("/api/cards/:uid",{userID:"@uid"});return b}]),angular.module("commonApp").factory("njCachedCards",["njCard",function(a){var b,c;return{setUID:function(a){c=a},query:function(){return b||(b=a.query({uid:c})),b}}}])}(),$(function(){function a(){e.offsetTop-c.scrollTop<=0?c.scrollTop-=d.offsetHeight:c.scrollTop++}$("#imgFocus").Carousel({ImgContentID:"ImgContent",ImgListClass:"selectLi",events:"click",AutoPlay:!0,speed:5e3,Styles:"opa",mobileSpeed:500});var b=80,c=document.getElementById("demo"),d=document.getElementById("demo1"),e=document.getElementById("demo2");e.innerHTML=d.innerHTML;var f=setInterval(a,b);c.onmouseover=function(){clearInterval(f)},c.onmouseout=function(){f=setInterval(a,b)}}),$(document).ready(function(){function a(){var a=$("#apply_serial_id")[0].innerText;$.post("/user/apply_close/"+a,{},function(){console.log("close apply done")}).done(function(){console.log("close apply success"),window.location.assign("/apply_detail/"+a)}).fail(function(){console.log("close apply error"),$(".jq_jsBox03").show()}).always(function(){console.log("close apply finished"),$(".jq_jsBox02").hide()})}moment.locale("zh-cn"),$("#verify-code-btn").click(function(){var a=$(this),b=$("#mobile")[0].value;if(!b||0!==b.search(/1[3|5|7|8|][0-9]{9}$/))return void $("#correct-mobile-alert").modal({});var c=0;a.addClass("am-disabled"),a[0].innerText="60秒后重试";var d=setInterval(function(){++c,a[0].innerText=60-c+"秒后重试",60===c&&(clearInterval(d),a[0].innerText="获取验证码",a.removeClass("am-disabled"))},1e3),e={mobile:b.trim()};$.get("/api/send_sms_verify_code",e,function(){})}),$("#get-profit").on("click",function(a){a.preventDefault();var b=$("#apply_serial_id")[0].value;window.location.assign("/apply/get_profit/"+b)});$("#add-deposit").on("click",function(a){a.preventDefault();var b=$("#apply_serial_id")[0].value;window.location.assign("/apply/add_deposit/"+b)}),$("#apply-postpone").on("click",function(a){a.preventDefault();var b=$("#apply_serial_id")[0].value;window.location.assign("/apply/apply_postpone/"+b)}),$(".jq_loginClose").click(function(){$(".jq_recTcc").hide()}),$(".jq_jsBtn02").click(function(a){a.preventDefault(),$(".jq_jsBox").show()}),$(".jq_jsBtn01").click(function(a){a.preventDefault(),$(".jq_jsBox01").hide(),$(".jq_jsBox02").show()}),$(".jq_jsBtn03").click(function(b){b.preventDefault(),a()}),$(".jq_bcbzjBtn").click(function(a){a.preventDefault(),$(".jq_bzbzj").show()}),$(".jq_btn01").click(function(){if(console.log(window.niujin_adding_deposit),window.niujin_adding_deposit)return void alert("正在处理中，请稍侯");var a=$("#apply_serial_id")[0].innerText,b=Number($("#add_deposit_input")[0].value);return 0>=b||b>3e4?void alert("请输入有效的金额，金额大于0元小于3万元"):(window.niujin_adding_deposit=!0,void $.post("/apply/add_deposit/"+a,{deposit_amount:b},function(){console.log("post add deposit done"),window.niujin_adding_deposit=!1}).done(function(a){a.paid?$(".jq_bzbzjbox_success").show():(window.open("/recharge?order_id="+a.order._id),$(".jq_bzbzjbox").show())}).fail(function(){$(".jq_bzbzjbox_fail").show()}).always(function(){$(".jq_bzbzjbox2").hide()}))}),$(".jq_btn02").click(function(){$(".jq_bzbzjbox").hide(),$(".jq_bzbzjbox3").show()}),$(".jq_btn_fail").click(function(){$(".jq_bzbzjbox_fail").hide()}),$(".jq_yqBtn03").click(function(a){a.preventDefault(),$(".jq_yqBox").show()}),$(".jq_yzBtn01").click(function(){var a=Number($("#postpone_input")[0].value);if(0>=a||a>22)return void alert("请输入有效的日期，日期大于1小于23");var b=$("#apply_serial_id")[0].innerText;$.post("/apply/apply_postpone/"+b,{period:a},function(){console.log("post postpone done")}).done(function(a){a.paid?$(".jq_yqBox_success").show():(window.open("/recharge?order_id="+a.order._id),$(".jq_yqBox02").show())}).fail(function(a){403===a.status&&console.log(JSON.parse(a.responseText).error_msg),$(".jq_yqBox_fail").show()}).always(function(){$(".jq_yqBox01").hide()})}),$(".jq_yqBtn02").click(function(){$(".jq_yqBox02").hide(),$(".jq_yqBox03").show()})}),function(a){a.fn.showTip=function(a,b){if("INPUT"===this[0].tagName){var c=this.siblings(".tip");switch(a.type){case"success":this.css("borderColor","#ddd"),c.html('<b class="correct"></b>').show();break;case"error":this.css("borderColor","red"),c.html('<b class="error"></b><b style="color:red;">'+a.msg+"</b>").show();break;case"clear":this.css("borderColor","#ddd"),c.hide();break;default:this.css("borderColor","#ddd"),c.text(a.msg).show()}b&&b()}},a("input").focus(function(){a(this).css("borderColor","#4d90fe")}).blur(function(){a(this).css("borderColor","#ddd")}),a.fn.countdown=function(b){var c;return function(){if(!c){var d=a(this),e=b,f={text:d.text(),color:d.css("color")};d.css({color:"#c5c5c5",cursor:"text"}).text("（"+e+"）重发验证码"),c=setInterval(function(){d.text("（"+(e-=1)+"）重发验证码"),-1===e&&(c=clearInterval(c),d.text(f.text).css({color:f.color,cursor:"auto"}))},1e3)}return this}}(60)}(jQuery),$(function(){var a=$("#phone"),b=$(".get-num-box"),c=!("oninput"in document.createElement("input"));a.bind(c?"keyup":"input",function(){for(var c=a.val().replace(/[^\d]/gm,"").split(""),d="",e=0;e<c.length;e++)d+=c[e],e+1==c.length||e+1!==3&&e+1!==7||(d+="");a.val(d);var f="";for(e=0;e<c.length;e++)13>e+1&&(f+="<span>"+c[e]+"</span>"),e+1==c.length||e+1!==3&&e+1!==7||(f+='<em class="space"></em>');b.html(f),d.length?b.show():b.hide()}),a.blur(function(){b.hide()})}),$(function(){$("#jq_tableBox tr:even td").css("background","#f5f5f5"),$("#jq_tableBox2 tr:even td").css("background","#f5f5f5"),$("#jq_tableBox3 tr:even td").css("background","#f5f5f5"),$("#tableMenu li").click(function(){var a=$(this).index();$(this).addClass("select").siblings().removeClass("select"),$("#tableMain>div").eq(a).show().siblings().hide()})}),angular.module("myApp").factory("gbIdentity",["$window",function(a){var b;return a.bootstrappedUserObject&&(b={},angular.extend(b,a.bootstrappedUserObject)),{currentUser:b}}]),function(){"use strict";angular.module("mainApp",["ui.bootstrap","commonApp"]),angular.module("mainApp").config(["$httpProvider",function(a){a.defaults.headers.get||(a.defaults.headers.get={}),a.defaults.headers.get["Cache-Control"]="no-cache",a.defaults.headers.get.Pragma="no-cache"}]),angular.module("mainApp").controller("MainApplyController",["$http","$location","$window","days","util",function(a,b,c,d,e){function f(){j.summary.lever=j.selectedLever.value,j.summary.deposit=j.summary.amount*k,j.summary.warnValue=e.getWarnValue(j.summary.amount,j.summary.deposit),j.summary.sellValue=e.getSellValue(j.summary.amount,j.summary.deposit),j.summary.deposit=j.summary.amount*k,j.summary.serviceCharge=e.getServiceCharge(j.summary.lever);var a=j.summary.amount/1e4*j.summary.serviceCharge;j.summary.charge=a,j.summary.total=j.summary.deposit+a,j.endTime=d.endTime(l,j.summary.day)}function g(){angular.forEach(j.amountList,function(a){a.select=!1})}function h(){j.otherAmount>=j.min_amount?j.otherAmount<=j.max_amount?j.summary.amount=Math.floor(j.otherAmount):j.otherAmount=j.summary.amount=j.max_amount:j.summary.amount=0,f()}function i(){a.post("/apply",j.summary).success(function(a){c.location.href="/apply_confirm/"+a.apply_serial_id}).error(function(a,b){401===b?j.showLoginWindow=!0:console.log(a.error_msg)})}var j=this;j.min_amount=2e3,j.max_amount=3e5;var k=.1,l=d.startTime();j.leverList=[{name:"10倍",value:10},{name:"9倍",value:9},{name:"8倍",value:8},{name:"7倍",value:7},{name:"6倍",value:6},{name:"5倍",value:5}],j.agree=!0,j.showOtherAmount=!1,j.otherAmount,j.showLoginWindow=!1,j.selectedLever=j.leverList[0],j.summary={day:1,amount:2e3},j.endTime=d.endTime(l,j.summary.day),j.forbiddenStockList,f(),j.amountList=[{name:"2000元",value:"2000",select:!0},{name:"1万",value:"10000"},{name:"2万",value:"20000"},{name:"3万",value:"30000"},{name:"5万",value:"50000"},{name:"10万",value:"100000"},{name:"20万",value:"200000"},{name:"30万",value:"300000"}],j.selectAmount=function(a){g(),j.showOtherAmount=!1,a.select=!0,j.summary.amount=a.value,f()},j.toggleOtherAmount=function(){j.showOtherAmount=!j.showOtherAmount,j.showOtherAmount?h():j.selectAmount(j.amountList[0])},j.finishOtherAmount=function(){h()},j.submitApply=function(){if(!j.agree)return void alert("您必须同意《牛金操盘协议》");if(j.summary.amount<=0||j.summary.amount>3e5){var a=$("#invalid-value-modal");return void a.modal("open")}i()},j.leverChange=function(){k=1/j.selectedLever.value,f()},j.showForbiddenStocks=function(){if(j.forbiddenStockList){var b=$("#forbidden-stock-modal");b.modal("open")}else a.get("/api/fetch_forbidden_stocks").success(function(a){j.forbiddenStockList=a;var b=$("#forbidden-stock-modal");b.modal({width:750,height:450})}).error(function(){})},j.login=function(){return j.mobile?j.password?void a.post("/api/login",{mobile:j.mobile,password:j.password}).success(function(){i()}).error(function(a){m("danger",a.error_msg)}):void m("danger","请输入密码，6到20位"):void m("danger","请输入有效的手机号")},j.alerts=[];var m=function(a,b){j.alerts=[],j.alerts.push({type:a,msg:b})};j.closeAlert=function(a){j.alerts.splice(a,1)}}]),angular.module("mainApp").controller("MainApplyConfirmController",["$http","$location","$window","days","util",function(a,b,c,d,e){function f(){g.apply.serviceCharge=e.getServiceCharge(g.apply.lever),g.serviceFee=g.apply.amount/1e4*e.getServiceCharge(g.apply.lever)*g.apply.period,g.totalAmount=g.apply.deposit+g.serviceFee,g.shouldPay=g.totalAmount-g.apply.userBalance,g.shouldPay<=0?(g.shouldPay=0,g.balancePay=!0):g.balancePay=!1}var g=this;g.apply={},c.bootstrappedApplyObject&&angular.extend(g.apply,c.bootstrappedApplyObject),g.validDays=[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22],f(),g.selectDay=function(){f()},g.payForApply=function(){g.apply.shouldPay=g.shouldPay,g.apply.totalAmount=g.totalAmount,a.post("/apply_confirm",g.apply).success(function(b){if(0===g.shouldPay){var d={apply_serial_id:b.apply.serialID,order_id:b.order._id};a.post("/api/users/pay_by_balance",d).success(function(){c.location.assign("/apply/pay_success?serial_id="+b.apply.serialID+"&amount="+b.apply.amount)}).error(function(a){console.log("error:"+a.error_msg)})}else c.location.assign("/recharge?order_id="+b.order._id)}).error(function(a,b){403===b&&alert("对不起，同一用户最多只能有5笔操盘中的配资。暂不能再申请新的配资。"),console.log("error:"+a.reason)})}}]),angular.module("mainApp").controller("MainYynCtrl",["$scope","$http","$location","$window","days","util",function(a,b,c,d,e,f){function g(){a.summary.type=2,a.summary.interestRate=a.selectedValue.i_value,b.post("/apply",a.summary).success(function(a){d.location.href="/yyn_confirm/"+a.apply_serial_id}).error(function(b,c){401===c?a.showLoginWindow=!0:console.log(b.error_msg)})}a.showLoginWindow=!1,a.forbiddenStockList,a.agree=!0,a.summary={},a.summary.deposit=0,a.summary.warnValue=0,a.summary.sellValue=0,a.parameterList=[{name:"2倍",interest:1.2,value:2,i_value:.012},{name:"3倍",interest:1.3,value:3,i_value:.013},{name:"4倍",interest:1.6,value:4,i_value:.016},{name:"5倍",interest:1.7,value:5,i_value:.017},{name:"6倍",interest:1.8,value:6,i_value:.018}],a.periodList=[];for(var h=1;6>=h;++h){var i={name:h+"个月",value:h};a.periodList.push(i)}a.selectedValue=a.parameterList[0],a.selectedMonth=a.periodList[0],a.summary.month=1,a.summary.charge=0,a.selectLever=function(b){console.log("run"),a.selectedValue=b,a.calculateValue()},a.calculateValue=function(){a.summary.amount>=5e5&&a.summary.amount<=3e6?(a.summary.lever=a.selectedValue.value,a.summary.deposit=a.summary.amount/a.selectedValue.value,a.summary.warnValue=f.getWarnValue(a.summary.amount,a.summary.deposit),a.summary.sellValue=f.getSellValue(a.summary.amount,a.summary.deposit),a.charge=(a.summary.amount-a.summary.deposit)*a.selectedValue.i_value,a.summary.charge=a.charge*a.summary.month):(a.summary.deposit=0,a.summary.warnValue=0,a.summary.sellValue=0,a.summary.charge=0)},a.monthChange=function(){a.summary.month=a.selectedMonth.value,a.calculateValue()},a.submitApply=function(){if(!a.agree)return void alert("您必须同意《牛金操盘协议》");if(a.summary.deposit<=0){var b=$("#invalid-value-modal");return void b.modal("open")}g()},a.showForbiddenStocks=function(){if(a.forbiddenStockList){var c=$("#forbidden-stock-modal");c.modal("open")}else b.get("/api/fetch_forbidden_stocks").success(function(b){a.forbiddenStockList=b;var c=$("#forbidden-stock-modal");c.modal({width:750,height:450})}).error(function(){})},a.login=function(){return a.mobile?a.password?void b.post("/api/login",{mobile:a.mobile,password:a.password}).success(function(){g()}).error(function(a){j("danger",a.error_msg)}):void j("danger","请输入密码，6到20位"):void j("danger","请输入有效的手机号")},a.alerts=[];var j=function(b,c){a.alerts=[],a.alerts.push({type:b,msg:c})};a.closeAlert=function(b){a.alerts.splice(b,1)}}]),angular.module("mainApp").controller("MainYYnConfirmCtrl",["$scope","$http","$location","$window","days",function(a,b,c,d){a.apply={},d.bootstrappedApplyObject&&angular.extend(a.apply,d.bootstrappedApplyObject),a.interest=(a.apply.amount-a.apply.deposit)*a.apply.interestRate,a.totalAmount=a.apply.deposit+a.interest,a.shouldPay=a.totalAmount-a.apply.userBalance,a.shouldPay<=0?(a.shouldPay=0,a.balancePay=!0):a.balancePay=!1,a.payForApply=function(){a.apply.shouldPay=a.shouldPay,a.apply.totalAmount=a.totalAmount,b.post("/apply_confirm",a.apply).success(function(c){if(0===a.shouldPay){var e={apply_serial_id:c.apply.serialID,order_id:c.order._id};b.post("/api/users/pay_by_balance",e).success(function(){d.location.assign("/apply/pay_success?serial_id="+c.apply.serialID+"&amount="+c.apply.amount)}).error(function(a){console.log("error:"+a.error_msg)})}else d.location.assign("/recharge?order_id="+c.order._id)}).error(function(a,b){403===b&&alert("对不起，同一用户最多只能有5笔操盘中的配资。暂不能再申请新的配资。"),console.log("error:"+a.reason)})}}])}(),function(){"use strict";angular.module("rechargeApp",["ngResource","ngRoute","ui.bootstrap","commonApp"]),angular.module("rechargeApp").config(["$httpProvider",function(a){a.defaults.headers.get||(a.defaults.headers.get={}),a.defaults.headers.get["Cache-Control"]="no-cache",a.defaults.headers.get.Pragma="no-cache"}]),angular.module("rechargeApp").controller("RechargeCtrl",["$scope","$window","$location","$http","njUser","njOrder","BankNameList",function(a,b,c,d,e,f,g){function h(a){j.user.lastPayBank=j.payBank,d.post("/api/user/"+j.user._id,j.user).success(function(a){j.user=a,console.log("lastPayBank updated")}).error(function(){console.log("lastPayBank update failed")});$("#OrderNo")[0].value=a._id,$("#OrderAmount")[0].value=a.amount.toFixed(2),$("#InstCode")[0].value=g[j.payBank].instCode,$("#BuyerIp")[0].value=b.returnCitySN.cip;$("#shengPayForm")[0].submit()}function i(){j.pay_amount=j.pay_order.amount,j.useBalance&&(j.pay_amount-=j.user.finance.balance)}var j=this;j.user=b.bootstrappedUserObject,j.pay_order=b.bootstrappedOrderObject,j.currentPayType=0,j.useCredit=!1,j.BankNameList=g,j.useBalance=!1,j.user.finance.balance>0&&(j.useBalance=!0,i()),j.BankNameLists=[];for(var k=[],l=0;l<g.length;++l)4===k.length&&(j.BankNameLists.push(k),k=[]),k.push(g[l]);k.length>0&&j.BankNameLists.push(k),j.btnName="更换银行",j.showAlipayWindow=!1,j.showPayConfirm=!1,j.showBankTransWindow=!1,j.paying=!1,j.bankObj=j.BankNameList[0],j.payBank=-1,j.alipayConfirm=!1,j.user.lastPayBank>=0?j.payBank=j.user.lastPayBank:(j.btnName="收起",$(".jq_rec2_yhBox").toggleClass("rec2_yhBoxSelected"),$(".jq_rec2_yhkList").slideToggle(200)),j.smsSend=!1,j.alipayAccountConfirm=!1,j.user.profile.alipay_account&&(j.alipayAccountConfirm=!0,j.alipay_account=j.user.profile.alipay_account,j.alipay_name=j.user.profile.alipay_name),j.payTypes=[{name:"网银充值",value:0},{name:"支付宝转账",value:1},{name:"银行汇款",value:2}],j.alerts=[],i();var m=function(a,b){j.alerts=[],j.alerts.push({type:a,msg:b})};j.closeAlert=function(a){j.alerts.splice(a,1)},j.selectPayType=function(a){j.alerts=[],j.alipayConfirm=!1,j.currentPayType=a,2===j.currentPayType&&(j.showBankTransWindow=!0),1===j.currentPayType&&(j.showAlipayWindow=!0)},j.selectPayBank=function(a){j.payBank=a.value,$(".jq_rec2_yhBox").toggleClass("rec2_yhBoxSelected"),$(".jq_rec2_yhkList").slideToggle(200),j.btnName="更换银行"},j.changeBtnName=function(){j.btnName="更换银行"===j.btnName?"收起":"更换银行"},j.changeCardType=function(a){j.useCredit=a,j.BankNameList=j.useCredit?g.filter(function(a){return a.credit}):g},j.sendSMSBankInfo=function(){if(m("success","信息已发送，请勿重复点击"),!j.smsSend){j.smsSend=!0;var a="户名：北京小牛普惠科技有限公司，账号：110912609510501，开户行：招商银行股份有限公司北京清华园支行";d.post("/api/send_sms",{sms_content:a}).success(function(){m("success","短信发送成功")}).error(function(){m("danger","短信发送失败，请稍后重试")})}},j.balanceChecked=function(){i()},j.gotoPay=function(){return-1===j.payBank?void m("danger","请先选择付款银行"):void(j.showPayConfirm=!0)},j.onlinePay=function(){j.pay_amount=Number(j.pay_amount.toFixed(2)),j.pay_order.amount=j.pay_amount,j.paying=!0,d.post("/api/user/"+j.user._id+"/orders/"+j.pay_order._id,j.pay_order).success(function(){console.log("order update success"),h(j.pay_order)}).error(function(){console.log("order update failed"),m("danger","服务暂时不可用，请稍后再试")})},j.closeOtherWindow=function(){j.smsSend=!1,j.showAlipayWindow=!1,j.showBankTransWindow=!1,j.alipayConfirm=!1,j.alerts=[]},j.aliPay=function(){return j.alipay_account?j.alipay_name?(j.alipayConfirm=!0,j.pay_amount=Number(j.pay_amount.toFixed(2)),j.pay_order.amount=j.pay_amount,j.pay_order.payType=3,j.pay_order.otherInfo=j.alipay_account,j.pay_order.transID=j.alipay_name,void d.post("/api/user/"+j.user._id+"/orders/"+j.pay_order._id,j.pay_order).success(function(){console.log("order update success")}).error(function(){j.alipayConfirm=!1,403===response.status?m("danger",response.data):(console.log("order update failed"),m("danger","服务暂时不可用，请稍后再试"))})):void m("danger","请输入支付宝实名认证姓名"):void m("danger","请输入支付宝账户")}}])}(),function(){"use strict";angular.module("registerApp",["ui.bootstrap","commonApp"]),angular.module("registerApp").config(["$httpProvider",function(a){a.defaults.headers.get||(a.defaults.headers.get={}),a.defaults.headers.get["Cache-Control"]="no-cache",a.defaults.headers.get.Pragma="no-cache"}]),angular.module("registerApp").controller("RegisterCtrl",["$http","$location","$window","$interval",function(a,b,c,d){var e=this;e.show_verify_window=!1,e.verify_code_error=!1,e.agree=!0,e.register=function(){if(!e.mobile)return void f("danger","请输入正确的手机号");if(!e.password)return void f("danger","请输入密码，长度6到20位");if(!e.confirm_password)return void f("danger","请再输一遍密码，长度6到20位");if(e.password!=e.confirm_password)return void f("danger","两次密码应该保持一致");if(!e.agree)return void f("danger","您必须同意牛金网用户协议");var b={mobile:e.mobile,password:e.password,confirm_password:e.confirm_password};a.post("/api/signup",b).success(function(){e.show_verify_window=!0,e.getVerifyCode()}).error(function(a){f("danger",a.error_msg)})},e.verifyCodeBtnText="获取验证码",e.verifyBtnDisabled=!1,e.getVerifyCode=function(b){if(!e.verifyBtnDisabled){e.verifyBtnDisabled=!0;var c=0;e.verifyCodeBtnText="60秒后重试";var f=d(function(){++c,e.verifyCodeBtnText=60-c+"秒后重试",60===c&&(d.cancel(f),e.verifyCodeBtnText="获取验证码",e.verifyBtnDisabled=!1)},1e3),g=b?2:1;a.get("/api/send_sms_verify_code?mobile="+e.mobile+"&type="+g).success(function(){}).error(function(){})}},e.confirmVerifyCode=function(){return e.verify_code?4!=e.verify_code.length?(e.signup_error_msg="验证码错误，请重新输入",void(e.verify_code_error=!0)):void a.post("/finish_signup",{mobile:e.mobile,verify_code:e.verify_code}).success(function(){c.location.replace("/welcome")}).error(function(a){e.signup_error_msg=a.error_msg,e.verify_code_error=!0}):(e.signup_error_msg="请输入验证码",void(e.verify_code_error=!0))},e.requestVerifyCode=function(){return e.mobile?void e.getVerifyCode(!0):void f("danger","请输入正确的手机号")},e.requestChangePassNext=function(){},e.requestChangePass=function(){return e.mobile?e.verify_code?e.password?e.confirm_password?e.password!==e.confirm_password?void f("danger","两次密码输入不一致"):void a.post("/forgot",{mobile:e.mobile,verify_code:e.verify_code,password:e.password,confirm_password:e.confirm_password}).success(function(){f("success","您的密码已经修改成功"),e.mobile="",e.verify_code="",e.password="",e.confirm_password=""}).error(function(a){f("danger",a.error_msg)}):void f("danger","请再输一遍密码，长度6到20位"):void f("danger","请输入密码，长度6到20位"):void f("danger","请输入验证码"):void f("danger","请输入正确的手机号")},e.login=function(){return e.mobile?e.password?void a.post("/api/login",{mobile:e.mobile,password:e.password}).success(function(a){c.location.replace(a.location?a.location:"/")
}).error(function(a){f("danger",a.error_msg)}):void f("danger","请输入密码，长度6到20位"):void f("danger","请输入正确的手机号")},e.alerts=[];var f=function(a,b){e.alerts=[],e.alerts.push({type:a,msg:b})};if(e.closeAlert=function(a){e.alerts.splice(a,1)},$("#server_error_msg_login")[0]){var g=$("#server_error_msg_login")[0].value;1==g?f("danger","手机号码错误，请重新输入"):2==g?f("danger","登录密码错误，请重新输入"):3==g&&f("danger","该手机号码还未注册")}}])}(),angular.module("myApp").factory("gbApply",["$resource",function(a){var b=a("/api/applies/:uid/apply/:aid",{userID:"@uid",applyID:"@aid"});return b}]),angular.module("myApp").factory("gbCard",["$resource",function(a){var b=a("/api/cards/:uid",{userID:"@uid"});return b}]),angular.module("myApp").factory("gbOrder",["$resource",function(a){var b=a("/api/user/:uid/orders/:id",{uid:"@userID",id:"@_id"});return b}]),angular.module("myApp").factory("gbCachedCards",["gbCard",function(a){var b,c;return{setUID:function(a){c=a},query:function(){return b||(b=a.query({uid:c})),b}}}]);